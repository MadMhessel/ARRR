# Плановый режим и откат изменений

## Что изменено
- Все шаблоны из `templates.js` получили схематичный вариант `schematicSvg()` и общую палитру классов (`shape`, `shape-fill`, `furn-center`).
- В `style.css` добавлены переменные плана, в `index.html` и `app.js` — переключение режимов (`svg-mode--schematic` / `svg-mode--rich`) и генерация `<symbol>` для повторного использования.
- `app.js` рендерит варианты через `renderItemTemplate()` и комбинирует динамические трансформации с сохранённым `core.dataset.baseTransform`, выбирая порядок на основе `getBBox()`.
- Логика стен использует маску `#wallOpeningsMask`, отдельные классы `.wall-body`/`.wall-edge` и конвертирует толщины в миллиметры листа.

## Как протестировать
1. Откройте `index.html` в браузере.
2. Примените к `<svg id="svg">` класс `svg-mode--schematic` (по умолчанию уже установлен) и проверьте, что мебель отображается упрощённо и центрирована (`core.getBBox()` в DevTools должен давать центр возле (0,0)).
3. Для проверки детального вида вызовите из консоли `setRenderMode('rich')` и убедитесь, что rich-варианты переключаются без смещений.
4. Нарисуйте 2–3 стены, добавьте двери/окна, убедитесь, что проёмы вырезаются маской и толщина соответствует типу.

## Файлы для отката
- `templates.js.bak` — исходный каталог шаблонов.
- `templates.schematic.patch.js` — патч со схематичными вариантами (можно применить повторно).
- `app.js.bak` — изначальный рендер и трансформации.
- `app.patched.js` — актуальная версия `app.js` с безопасной функцией `applyTransformFromDataset`.

### Быстрый откат к исходнику
```bash
cp templates.js.bak templates.js
cp app.js.bak app.js
```

### Переустановка патчей
```bash
cp app.patched.js app.js
node templates.schematic.patch.js > /dev/null 2>&1 # перегенерация схематичных шаблонов при необходимости
```

После отката перезапустите страницу, чтобы сбросить `localStorage` и убедиться, что объекты и стены отображаются корректно.
